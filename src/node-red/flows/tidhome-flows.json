[
    {
        "id": "8627a08f.2f4c18",
        "type": "tab",
        "label": "Notifications",
        "disabled": false,
        "info": ""
    },
    {
        "id": "4fc69d2d.235124",
        "type": "telegram bot",
        "z": "",
        "botname": "Ti-dhome-base",
        "usernames": "",
        "chatids": "",
        "baseapiurl": "",
        "updatemode": "polling",
        "pollinterval": "3000",
        "usesocks": false,
        "sockshost": "",
        "socksport": "6667",
        "socksusername": "anonymous",
        "sockspassword": "",
        "bothost": "",
        "localbotport": "8443",
        "publicbotport": "8443",
        "privatekey": "",
        "certificate": "",
        "useselfsignedcertificate": false,
        "verboselogging": true
    },
    {
        "id": "23793ec.9bf0742",
        "type": "catch",
        "z": "8627a08f.2f4c18",
        "name": "",
        "x": 110,
        "y": 50,
        "wires": [
            [
                "1eadd747.8b08a1"
            ]
        ]
    },
    {
        "id": "1eadd747.8b08a1",
        "type": "debug",
        "z": "8627a08f.2f4c18",
        "name": "Debug",
        "active": true,
        "tosidebar": true,
        "console": true,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 590,
        "y": 50,
        "wires": []
    },
    {
        "id": "8ada82a3.815fc8",
        "type": "telegram sender",
        "z": "8627a08f.2f4c18",
        "name": "Status",
        "bot": "4fc69d2d.235124",
        "x": 1180,
        "y": 230,
        "wires": [
            [
                "bd0c93c7.885df"
            ]
        ]
    },
    {
        "id": "bd0c93c7.885df",
        "type": "debug",
        "z": "8627a08f.2f4c18",
        "name": "Status",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 1320,
        "y": 230,
        "wires": []
    },
    {
        "id": "892680b5.f07978",
        "type": "sunrise",
        "z": "8627a08f.2f4c18",
        "name": "",
        "lat": "48.45",
        "lon": "-4.59",
        "start": "sunriseEnd",
        "end": "sunsetStart",
        "x": 90,
        "y": 370,
        "wires": [
            [],
            [
                "fa30df76.e0def",
                "bb8a9cc7.370598",
                "a473a8f3.eebb1",
                "4a628474.016e84",
                "468a476f.26bc3",
                "a68c9fbf.b8cd9"
            ]
        ]
    },
    {
        "id": "fa30df76.e0def",
        "type": "function",
        "z": "8627a08f.2f4c18",
        "name": "Hello Msg",
        "func": "var content = \"\"\nif(msg.payload === 1) {\n    content = \"Good morning!\"\n} else {\n    content = \"Good night !\"\n}\n\nmsg.payload = {\n    \"chatId\": context.global.telegramrecipients,\n    \"type\": \"message\",\n    \"options\": { \"parse_mode\": \"Markdown\" },\n    \"content\": content\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 290,
        "y": 230,
        "wires": [
            [
                "8ada82a3.815fc8"
            ]
        ]
    },
    {
        "id": "be0ac0f.eb38d4",
        "type": "comment",
        "z": "8627a08f.2f4c18",
        "name": "Daily hello's !",
        "info": "",
        "x": 90,
        "y": 230,
        "wires": []
    },
    {
        "id": "cb68db5a.bdbca8",
        "type": "inject",
        "z": "8627a08f.2f4c18",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "1",
        "x": 120,
        "y": 100,
        "wires": [
            [
                "177a4b9.7ffc534"
            ]
        ]
    },
    {
        "id": "a473a8f3.eebb1",
        "type": "file in",
        "z": "8627a08f.2f4c18",
        "name": "",
        "filename": "/opt/data/contacts.csv",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "x": 330,
        "y": 340,
        "wires": [
            [
                "f9f7f04d.3b6e58"
            ]
        ]
    },
    {
        "id": "f9f7f04d.3b6e58",
        "type": "csv",
        "z": "8627a08f.2f4c18",
        "name": "",
        "sep": ",",
        "hdrin": true,
        "hdrout": "",
        "multi": "one",
        "ret": "\\n",
        "temp": "",
        "skip": "0",
        "x": 590,
        "y": 320,
        "wires": [
            [
                "4881ab4d.cbd20c"
            ]
        ]
    },
    {
        "id": "1663ada5.b9933a",
        "type": "function",
        "z": "8627a08f.2f4c18",
        "name": "Render",
        "func": "if (msg.payload.birthday !== undefined) {\n    var message, bdom, bmonth;\n    bparsed = msg.payload.birthday.split(' ');\n    if(bparsed.length > 4) {\n        bparsed = msg.payload.birthday.split(' ');\n        bdow = bparsed[0]\n        bmonth = bparsed[1]\n        bdom = bparsed[2]\n        byear = bparsed[3]\n        message = \"Happy \" + (msg.myyear - byear) + \"th Birthday to \" + msg.payload.displayName + \" (\" + bdow + \" \" + byear + \"-\" + bmonth + \"-\" + bdom + \")\"\n    } else {\n        // basic day of year\n        bparsed = msg.payload.birthday.split('/');\n        bdom = parseInt(bparsed[0])\n        bmonth = parseInt(bparsed[1])\n        message = \"Happy Birthday to \" + msg.payload.displayName + \" (\" + bdom + \"/\" + bmonth + \")\"\n    } \n    \n    if(bdom == msg.mydom && (bmonth == msg.mymonth || bmonth == msg.mymonthn) ) {\n        msg.payload = {\n            \"chatId\": context.global.telegramrecipients,\n            \"type\": \"message\",\n            \"options\": { \"parse_mode\": \"Markdown\" },\n            \"content\": message\n        }\n        return msg;\n    }\n}\nreturn null;",
        "outputs": 1,
        "noerr": 0,
        "x": 1010,
        "y": 320,
        "wires": [
            [
                "8ada82a3.815fc8"
            ]
        ]
    },
    {
        "id": "4881ab4d.cbd20c",
        "type": "simpletime",
        "z": "8627a08f.2f4c18",
        "name": "now",
        "x": 740,
        "y": 320,
        "wires": [
            [
                "1663ada5.b9933a"
            ]
        ]
    },
    {
        "id": "49927fd6.934d3",
        "type": "comment",
        "z": "8627a08f.2f4c18",
        "name": "Birthdays today?",
        "info": "",
        "x": 100,
        "y": 300,
        "wires": []
    },
    {
        "id": "bb8a9cc7.370598",
        "type": "file in",
        "z": "8627a08f.2f4c18",
        "name": "",
        "filename": "/opt/data/contacts-basic.csv",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "x": 350,
        "y": 300,
        "wires": [
            [
                "f9f7f04d.3b6e58"
            ]
        ]
    },
    {
        "id": "59a67b31.f0ecec",
        "type": "comment",
        "z": "8627a08f.2f4c18",
        "name": "Saints today?",
        "info": "",
        "x": 90,
        "y": 450,
        "wires": []
    },
    {
        "id": "4a628474.016e84",
        "type": "file in",
        "z": "8627a08f.2f4c18",
        "name": "",
        "filename": "/opt/data/calendar-saints.csv",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "x": 350,
        "y": 450,
        "wires": [
            [
                "2513ca6b.11efe6"
            ]
        ]
    },
    {
        "id": "2513ca6b.11efe6",
        "type": "csv",
        "z": "8627a08f.2f4c18",
        "name": "",
        "sep": ";",
        "hdrin": true,
        "hdrout": "",
        "multi": "one",
        "ret": "\\n",
        "temp": "",
        "skip": "0",
        "x": 590,
        "y": 450,
        "wires": [
            [
                "c629f17b.ba7a6"
            ]
        ]
    },
    {
        "id": "c629f17b.ba7a6",
        "type": "simpletime",
        "z": "8627a08f.2f4c18",
        "name": "now",
        "x": 740,
        "y": 450,
        "wires": [
            [
                "a23580f8.0c33f8"
            ]
        ]
    },
    {
        "id": "a23580f8.0c33f8",
        "type": "function",
        "z": "8627a08f.2f4c18",
        "name": "Render",
        "func": "var message, bdom, bmonth;\nbparsed = msg.payload.date.split('/');\nif(bparsed.length > 0) {\n    bmonth = bparsed[0]\n    bdom = bparsed[1]\n    message = \"Happy day to \" + msg.payload.names\n    \n    if(bdom == msg.mydom && (bmonth == msg.mymonth || bmonth == msg.mymonthn) ) {\n        msg.payload = {\n            \"chatId\": context.global.telegramrecipients,\n            \"type\": \"message\",\n            \"options\": { \"parse_mode\": \"Markdown\" },\n            \"content\": message\n        }\n        return msg;\n    }\n} \nreturn null;",
        "outputs": 1,
        "noerr": 0,
        "x": 1010,
        "y": 450,
        "wires": [
            [
                "8ada82a3.815fc8"
            ]
        ]
    },
    {
        "id": "b90c4a5d.407e28",
        "type": "comment",
        "z": "8627a08f.2f4c18",
        "name": "Worldday today?",
        "info": "",
        "x": 100,
        "y": 520,
        "wires": []
    },
    {
        "id": "468a476f.26bc3",
        "type": "file in",
        "z": "8627a08f.2f4c18",
        "name": "",
        "filename": "/opt/data/calendar-world-days.csv",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "x": 370,
        "y": 520,
        "wires": [
            [
                "cf609b3b.1774e"
            ]
        ]
    },
    {
        "id": "cf609b3b.1774e",
        "type": "csv",
        "z": "8627a08f.2f4c18",
        "name": "",
        "sep": ",",
        "hdrin": true,
        "hdrout": "",
        "multi": "one",
        "ret": "\\n",
        "temp": "",
        "skip": "0",
        "x": 590,
        "y": 520,
        "wires": [
            [
                "3152a9b6.167896"
            ]
        ]
    },
    {
        "id": "3152a9b6.167896",
        "type": "simpletime",
        "z": "8627a08f.2f4c18",
        "name": "now",
        "x": 740,
        "y": 520,
        "wires": [
            [
                "60379aec.53683c"
            ]
        ]
    },
    {
        "id": "60379aec.53683c",
        "type": "function",
        "z": "8627a08f.2f4c18",
        "name": "Render",
        "func": "var message, bdom, bmonth;\nbparsed = msg.payload.date.split('/');\nif(bparsed.length > 0) {\n    bmonth = bparsed[1]\n    bdom = bparsed[0]\n    message = \"Today is the \" + msg.payload.description\n    \n    if(bdom == msg.mydom && (bmonth == msg.mymonth || bmonth == msg.mymonthn) ) {\n        msg.payload = {\n            \"chatId\": context.global.telegramrecipients,\n            \"type\": \"message\",\n            \"options\": { \"parse_mode\": \"Markdown\" },\n            \"content\": message\n        }\n        return msg;\n    }\n} \nreturn null;",
        "outputs": 1,
        "noerr": 0,
        "x": 1010,
        "y": 520,
        "wires": [
            [
                "8ada82a3.815fc8"
            ]
        ]
    },
    {
        "id": "a68c9fbf.b8cd9",
        "type": "openweathermap",
        "z": "8627a08f.2f4c18",
        "name": "Brest meteo",
        "wtype": "current",
        "lon": "",
        "lat": "",
        "city": "Brest",
        "country": "FR",
        "language": "fr",
        "x": 300,
        "y": 580,
        "wires": [
            [
                "8b517c2b.d93ed8"
            ]
        ]
    },
    {
        "id": "8b517c2b.d93ed8",
        "type": "function",
        "z": "8627a08f.2f4c18",
        "name": "Render",
        "func": "var message = msg.payload.description + '\\n' + \n    \"temp=\" + msg.payload.tempc + \" (\" + msg.payload.temp_minc + \" to \" + msg.payload.temp_maxc + \")\\n\" +\n    \"humidity=\" + msg.payload.humidity + \"\\n\" +\n    \"pressure=\" + msg.payload.pressure + \"\\n\" +\n    \"windspeed=\" + msg.payload.windspeed + \"\\n\" +\n    \"winddirection=\" + msg.payload.winddirection + \"\\n\" + \n    \"clouds=\" + msg.payload.clouds;\n    \nmsg.payload = {\n    \"chatId\": context.global.telegramrecipients,\n    \"type\": \"message\",\n    \"options\": { \"parse_mode\": \"Markdown\" },\n    \"content\": message \n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1010,
        "y": 580,
        "wires": [
            [
                "8ada82a3.815fc8"
            ]
        ]
    },
    {
        "id": "177a4b9.7ffc534",
        "type": "credentials",
        "z": "8627a08f.2f4c18",
        "name": "K",
        "props": [
            {
                "value": "telegramrecipients",
                "type": "msg"
            },
            {
                "value": "telegramusers",
                "type": "msg"
            }
        ],
        "x": 300,
        "y": 100,
        "wires": [
            [
                "873622d3.9c2c98"
            ]
        ]
    },
    {
        "id": "eedf2b90.5761",
        "type": "debug",
        "z": "8627a08f.2f4c18",
        "name": "Debug",
        "active": true,
        "tosidebar": true,
        "console": true,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 590,
        "y": 100,
        "wires": []
    },
    {
        "id": "873622d3.9c2c98",
        "type": "function",
        "z": "8627a08f.2f4c18",
        "name": "Save",
        "func": "context.global.telegramrecipients = msg.telegramrecipients\nreturn { topic: 'continue' };",
        "outputs": 1,
        "noerr": 0,
        "x": 450,
        "y": 100,
        "wires": [
            [
                "eedf2b90.5761"
            ]
        ]
    },
    {
        "id": "4538aa4.a46a354",
        "type": "comment",
        "z": "8627a08f.2f4c18",
        "name": "Meteo",
        "info": "",
        "x": 70,
        "y": 580,
        "wires": []
    },
    {
        "id": "27e97ec9.6379e2",
        "type": "inject",
        "z": "8627a08f.2f4c18",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 80,
        "y": 620,
        "wires": [
            [
                "a68c9fbf.b8cd9"
            ]
        ]
    }
]