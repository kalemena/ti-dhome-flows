version: '3.7'

services:

  mqtt:
    image: eclipse-mosquitto:1.4.12
    restart: always
    # ports:
    #  - "2883:1883"
    #  - "29001:9001"

  nodered:
    #image: kalemena/node-red:latest
    build: src/tidhome
    restart: always
    ports:
     - "2880:1880"
    volumes:
     - ./src/tidhome:/opt/tidhome
     - ./src/tidhome/config:/root/.node-red
    devices:
     - "/dev/ttyCurrenCost:/dev/ttyCurrenCost"
     - "/dev/ttyJeeLink:/dev/ttyJeeLink"
    environment:
     - FLOWS=/opt/tidhome/flows/tidhome-flows.json
